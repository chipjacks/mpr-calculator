module MPRLevel exposing (timeToSeconds, lookup, equivalentRaceTimes, trainingPaces)

import Json.Decode exposing (decodeString, dict, list, string)
import Dict exposing (Dict)
import Result

distanceList : List String
distanceList = ["5k", "8k", "5mi", "10k", "15k", "10mi", "20k", "HalfMar", "25k", "30k", "Marathon"]

paceList : List String
paceList = ["Easy", "Moderate", "SteadyState", "Brisk", "AerobicThreshold", "LactateThreshold", "Groove", "VO2Max", "Fast"]

neutralRunnerJson = """{"5k":["0:28:00","0:27:45","0:27:30","0:27:15","0:27:00","0:26:45","0:26:30","0:26:15","0:26:00","0:25:45","0:25:30","0:25:15","0:25:00","0:24:45","0:24:30","0:24:15","0:24:00","0:23:45","0:23:30","0:23:15","0:23:00","0:22:45","0:22:30","0:22:15","0:22:00","0:21:45","0:21:30","0:21:15","0:21:00","0:20:45","0:20:30","0:20:15","0:20:00","0:19:45","0:19:30","0:19:15","0:19:00","0:18:45","0:18:30","0:18:15","0:18:00","0:17:45","0:17:30","0:17:15","0:17:00","0:16:45","0:16:30","0:16:15","0:16:00","0:15:45","0:15:30","0:15:15","0:15:00","0:14:45","0:14:30","0:14:15","0:14:00","0:13:45","0:13:30","0:13:15","0:13:00"],"8k":["0:46:01","0:45:36","0:45:11","0:44:47","0:44:22","0:43:57","0:43:33","0:43:08","0:42:43","0:42:19","0:41:54","0:41:29","0:41:05","0:40:40","0:40:16","0:39:51","0:39:26","0:39:02","0:38:37","0:38:12","0:37:48","0:37:23","0:36:58","0:36:34","0:36:09","0:35:44","0:35:20","0:34:55","0:34:30","0:34:06","0:33:41","0:33:16","0:32:52","0:32:27","0:32:03","0:31:38","0:31:13","0:30:49","0:30:24","0:29:59","0:29:35","0:29:10","0:28:45","0:28:21","0:27:56","0:27:31","0:27:07","0:26:42","0:26:17","0:25:53","0:25:28","0:25:04","0:24:39","0:24:14","0:23:50","0:23:25","0:23:00","0:22:36","0:22:11","0:21:46","0:21:22"],"5mi":["0:46:17","0:45:52","0:45:27","0:45:02","0:44:38","0:44:13","0:43:48","0:43:23","0:42:58","0:42:34","0:42:09","0:41:44","0:41:19","0:40:54","0:40:30","0:40:05","0:39:40","0:39:15","0:38:51","0:38:26","0:38:01","0:37:36","0:37:11","0:36:47","0:36:22","0:35:57","0:35:32","0:35:07","0:34:43","0:34:18","0:33:53","0:33:28","0:33:03","0:32:39","0:32:14","0:31:49","0:31:24","0:30:59","0:30:35","0:30:10","0:29:45","0:29:20","0:28:55","0:28:31","0:28:06","0:27:41","0:27:16","0:26:52","0:26:27","0:26:02","0:25:37","0:25:12","0:24:48","0:24:23","0:23:58","0:23:33","0:23:08","0:22:44","0:22:19","0:21:54","0:21:29"],"10k":["0:58:31","0:58:00","0:57:28","0:56:57","0:56:26","0:55:54","0:55:23","0:54:52","0:54:20","0:53:49","0:53:18","0:52:46","0:52:15","0:51:44","0:51:12","0:50:41","0:50:10","0:49:38","0:49:07","0:48:36","0:48:04","0:47:33","0:47:01","0:46:30","0:45:59","0:45:27","0:44:56","0:44:25","0:43:53","0:43:22","0:42:51","0:42:19","0:41:48","0:41:17","0:40:45","0:40:14","0:39:43","0:39:11","0:38:40","0:38:09","0:37:37","0:37:06","0:36:34","0:36:03","0:35:32","0:35:00","0:34:29","0:33:58","0:33:26","0:32:55","0:32:24","0:31:52","0:31:21","0:30:50","0:30:18","0:29:47","0:29:16","0:28:44","0:28:13","0:27:42","0:27:10"],"15k":["1:29:45","1:28:57","1:28:09","1:27:21","1:26:33","1:25:45","1:24:57","1:24:09","1:23:21","1:22:33","1:21:44","1:20:56","1:20:08","1:19:20","1:18:32","1:17:44","1:16:56","1:16:08","1:15:20","1:14:32","1:13:44","1:12:56","1:12:07","1:11:19","1:10:31","1:09:43","1:08:55","1:08:07","1:07:19","1:06:31","1:05:43","1:04:55","1:04:07","1:03:19","1:02:30","1:01:42","1:00:54","1:00:06","0:59:18","0:58:30","0:57:42","0:56:54","0:56:06","0:55:18","0:54:30","0:53:42","0:52:53","0:52:05","0:51:17","0:50:29","0:49:41","0:48:53","0:48:05","0:47:17","0:46:29","0:45:41","0:44:53","0:44:05","0:43:16","0:42:28","0:41:40"],"10mi":["1:36:44","1:35:52","1:35:00","1:34:08","1:33:16","1:32:24","1:31:33","1:30:41","1:29:49","1:28:57","1:28:05","1:27:14","1:26:22","1:25:30","1:24:38","1:23:46","1:22:54","1:22:03","1:21:11","1:20:19","1:19:27","1:18:35","1:17:44","1:16:52","1:16:00","1:15:08","1:14:16","1:13:24","1:12:33","1:11:41","1:10:49","1:09:57","1:09:05","1:08:14","1:07:22","1:06:30","1:05:38","1:04:46","1:03:54","1:03:03","1:02:11","1:01:19","1:00:27","0:59:35","0:58:44","0:57:52","0:57:00","0:56:08","0:55:16","0:54:24","0:53:33","0:52:41","0:51:49","0:50:57","0:50:05","0:49:14","0:48:22","0:47:30","0:46:38","0:45:46","0:44:54"],"20k":["2:02:18","2:01:13","2:00:07","1:59:02","1:57:56","1:56:51","1:55:45","1:54:40","1:53:34","1:52:29","1:51:23","1:50:18","1:49:12","1:48:07","1:47:01","1:45:56","1:44:50","1:43:45","1:42:39","1:41:33","1:40:28","1:39:22","1:38:17","1:37:11","1:36:06","1:35:00","1:33:55","1:32:49","1:31:44","1:30:38","1:29:33","1:28:27","1:27:22","1:26:16","1:25:11","1:24:05","1:23:00","1:21:54","1:20:49","1:19:43","1:18:38","1:17:32","1:16:27","1:15:21","1:14:15","1:13:10","1:12:04","1:10:59","1:09:53","1:08:48","1:07:42","1:06:37","1:05:31","1:04:26","1:03:20","1:02:15","1:01:09","1:00:04","0:58:58","0:57:53","0:56:47"],"HalfMarathon":["2:09:38","2:08:28","2:07:19","2:06:09","2:05:00","2:03:50","2:02:41","2:01:32","2:00:22","1:59:13","1:58:03","1:56:54","1:55:44","1:54:35","1:53:25","1:52:16","1:51:07","1:49:57","1:48:48","1:47:38","1:46:29","1:45:19","1:44:10","1:43:00","1:41:51","1:40:42","1:39:32","1:38:23","1:37:13","1:36:04","1:34:54","1:33:45","1:32:35","1:31:26","1:30:17","1:29:07","1:27:58","1:26:48","1:25:39","1:24:29","1:23:20","1:22:10","1:21:01","1:19:52","1:18:42","1:17:33","1:16:23","1:15:14","1:14:04","1:12:55","1:11:46","1:10:36","1:09:27","1:08:17","1:07:08","1:05:58","1:04:49","1:03:39","1:02:30","1:01:21","1:00:11"],"25k":["2:34:36","2:33:13","2:31:51","2:30:28","2:29:05","2:27:42","2:26:19","2:24:56","2:23:34","2:22:11","2:20:48","2:19:25","2:18:02","2:16:40","2:15:17","2:13:54","2:12:31","2:11:08","2:09:45","2:08:23","2:07:00","2:05:37","2:04:14","2:02:51","2:01:28","2:00:06","1:58:43","1:57:20","1:55:57","1:54:34","1:53:12","1:51:49","1:50:26","1:49:03","1:47:40","1:46:17","1:44:55","1:43:32","1:42:09","1:40:46","1:39:23","1:38:00","1:36:38","1:35:15","1:33:52","1:32:29","1:31:06","1:29:44","1:28:21","1:26:58","1:25:35","1:24:12","1:22:49","1:21:27","1:20:04","1:18:41","1:17:18","1:15:55","1:14:32","1:13:10","1:11:47"],"30k":["3:07:35","3:05:55","3:04:14","3:02:34","3:00:53","2:59:13","2:57:32","2:55:52","2:54:11","2:52:31","2:50:50","2:49:10","2:47:29","2:45:49","2:44:08","2:42:28","2:40:47","2:39:07","2:37:26","2:35:46","2:34:05","2:32:25","2:30:44","2:29:04","2:27:23","2:25:43","2:24:02","2:22:22","2:20:41","2:19:01","2:17:20","2:15:40","2:13:59","2:12:19","2:10:39","2:08:58","2:07:18","2:05:37","2:03:57","2:02:16","2:00:36","1:58:55","1:57:15","1:55:34","1:53:54","1:52:13","1:50:33","1:48:52","1:47:12","1:45:31","1:43:51","1:42:10","1:40:30","1:38:49","1:37:09","1:35:28","1:33:48","1:32:07","1:30:27","1:28:46","1:27:06"],"Marathon":["4:30:21","4:27:56","4:25:31","4:23:06","4:20:42","4:18:17","4:15:52","4:13:27","4:11:02","4:08:37","4:06:13","4:03:48","4:01:23","3:58:58","3:56:33","3:54:08","3:51:44","3:49:19","3:46:54","3:44:29","3:42:04","3:39:39","3:37:15","3:34:50","3:32:25","3:30:00","3:27:35","3:25:10","3:22:46","3:20:21","3:17:56","3:15:31","3:13:06","3:10:42","3:08:17","3:05:52","3:03:27","3:01:02","2:58:37","2:56:13","2:53:48","2:51:23","2:48:58","2:46:33","2:44:08","2:41:44","2:39:19","2:36:54","2:34:29","2:32:04","2:29:39","2:27:15","2:24:50","2:22:25","2:20:00","2:17:35","2:15:10","2:12:46","2:10:21","2:07:56","2:05:31"]}"""
trainingPacesJson = """
  {"1":[["0:11:29","0:12:38"],["0:11:04","0:11:09"],["0:10:38","0:10:44"],["0:10:13","0:10:18"],["0:09:48","0:09:53"],["0:09:22","0:09:27"],["0:08:57","0:09:02"],["0:08:32","0:08:36"],["0:08:06","0:08:11"]],"2":[["0:11:23","0:12:31"],["0:10:58","0:11:04"],["0:10:33","0:10:38"],["0:10:08","0:10:13"],["0:09:43","0:09:48"],["0:09:17","0:09:22"],["0:08:52","0:08:57"],["0:08:27","0:08:32"],["0:08:02","0:08:06"]],"3":[["0:11:17","0:12:25"],["0:10:52","0:10:58"],["0:10:27","0:10:33"],["0:10:02","0:10:08"],["0:09:37","0:09:43"],["0:09:13","0:09:17"],["0:08:48","0:08:52"],["0:08:23","0:08:27"],["0:07:58","0:08:02"]],"4":[["0:11:11","0:12:18"],["0:10:46","0:10:52"],["0:10:22","0:10:27"],["0:09:57","0:10:02"],["0:09:32","0:09:37"],["0:09:08","0:09:13"],["0:08:43","0:08:48"],["0:08:18","0:08:23"],["0:07:54","0:07:58"]],"5":[["0:11:05","0:12:11"],["0:10:41","0:10:46"],["0:10:16","0:10:22"],["0:09:52","0:09:57"],["0:09:27","0:09:32"],["0:09:03","0:09:08"],["0:08:38","0:08:43"],["0:08:14","0:08:18"],["0:07:50","0:07:54"]],"6":[["0:10:59","0:12:05"],["0:10:35","0:10:41"],["0:10:11","0:10:16"],["0:09:46","0:09:52"],["0:09:22","0:09:27"],["0:08:58","0:09:03"],["0:08:34","0:08:38"],["0:08:10","0:08:14"],["0:07:45","0:07:50"]],"7":[["0:10:53","0:11:58"],["0:10:29","0:10:35"],["0:10:05","0:10:11"],["0:09:41","0:09:46"],["0:09:17","0:09:22"],["0:08:53","0:08:58"],["0:08:29","0:08:34"],["0:08:05","0:08:10"],["0:07:41","0:07:45"]],"8":[["0:10:47","0:11:52"],["0:10:23","0:10:29"],["0:09:59","0:10:05"],["0:09:36","0:09:41"],["0:09:12","0:09:17"],["0:08:48","0:08:53"],["0:08:24","0:08:29"],["0:08:01","0:08:05"],["0:07:37","0:07:41"]],"9":[["0:10:41","0:11:45"],["0:10:17","0:10:23"],["0:09:54","0:09:59"],["0:09:30","0:09:36"],["0:09:07","0:09:12"],["0:08:43","0:08:48"],["0:08:20","0:08:24"],["0:07:56","0:08:01"],["0:07:33","0:07:37"]],"10":[["0:10:35","0:11:39"],["0:10:12","0:10:17"],["0:09:48","0:09:54"],["0:09:25","0:09:30"],["0:09:02","0:09:07"],["0:08:38","0:08:43"],["0:08:15","0:08:20"],["0:07:52","0:07:56"],["0:07:28","0:07:33"]],"11":[["0:10:29","0:11:32"],["0:10:06","0:10:12"],["0:09:43","0:09:48"],["0:09:20","0:09:25"],["0:08:57","0:09:02"],["0:08:34","0:08:38"],["0:08:10","0:08:15"],["0:07:47","0:07:52"],["0:07:24","0:07:28"]],"12":[["0:10:23","0:11:25"],["0:10:00","0:10:06"],["0:09:37","0:09:43"],["0:09:14","0:09:20"],["0:08:52","0:08:57"],["0:08:29","0:08:34"],["0:08:06","0:08:10"],["0:07:43","0:07:47"],["0:07:20","0:07:24"]],"13":[["0:10:17","0:11:19"],["0:09:54","0:10:00"],["0:09:32","0:09:37"],["0:09:09","0:09:14"],["0:08:46","0:08:52"],["0:08:24","0:08:29"],["0:08:01","0:08:06"],["0:07:38","0:07:43"],["0:07:16","0:07:20"]],"14":[["0:10:11","0:11:12"],["0:09:49","0:09:54"],["0:09:26","0:09:32"],["0:09:04","0:09:09"],["0:08:41","0:08:46"],["0:08:19","0:08:24"],["0:07:56","0:08:01"],["0:07:34","0:07:38"],["0:07:12","0:07:16"]],"15":[["0:10:05","0:11:06"],["0:09:43","0:09:49"],["0:09:21","0:09:26"],["0:08:58","0:09:04"],["0:08:36","0:08:41"],["0:08:14","0:08:19"],["0:07:52","0:07:56"],["0:07:30","0:07:34"],["0:07:07","0:07:12"]],"16":[["0:09:59","0:10:59"],["0:09:37","0:09:43"],["0:09:15","0:09:21"],["0:08:53","0:08:58"],["0:08:31","0:08:36"],["0:08:09","0:08:14"],["0:07:47","0:07:52"],["0:07:25","0:07:30"],["0:07:03","0:07:07"]],"17":[["0:09:53","0:10:52"],["0:09:31","0:09:37"],["0:09:10","0:09:15"],["0:08:48","0:08:53"],["0:08:26","0:08:31"],["0:08:04","0:08:09"],["0:07:42","0:07:47"],["0:07:21","0:07:25"],["0:06:59","0:07:03"]],"18":[["0:09:47","0:10:46"],["0:09:26","0:09:31"],["0:09:04","0:09:10"],["0:08:42","0:08:48"],["0:08:21","0:08:26"],["0:07:59","0:08:04"],["0:07:38","0:07:42"],["0:07:16","0:07:21"],["0:06:55","0:06:59"]],"19":[["0:09:41","0:10:39"],["0:09:20","0:09:26"],["0:08:58","0:09:04"],["0:08:37","0:08:42"],["0:08:16","0:08:21"],["0:07:54","0:07:59"],["0:07:33","0:07:38"],["0:07:12","0:07:16"],["0:06:50","0:06:55"]],"20":[["0:09:35","0:10:33"],["0:09:14","0:09:20"],["0:08:53","0:08:58"],["0:08:32","0:08:37"],["0:08:11","0:08:16"],["0:07:50","0:07:54"],["0:07:28","0:07:33"],["0:07:07","0:07:12"],["0:06:46","0:06:50"]],"21":[["0:09:29","0:10:26"],["0:09:08","0:09:14"],["0:08:47","0:08:53"],["0:08:26","0:08:32"],["0:08:06","0:08:11"],["0:07:45","0:07:50"],["0:07:24","0:07:28"],["0:07:03","0:07:07"],["0:06:42","0:06:46"]],"22":[["0:09:23","0:10:20"],["0:09:03","0:09:08"],["0:08:42","0:08:47"],["0:08:21","0:08:26"],["0:08:00","0:08:06"],["0:07:40","0:07:45"],["0:07:19","0:07:24"],["0:06:58","0:07:03"],["0:06:38","0:06:42"]],"23":[["0:09:17","0:10:13"],["0:08:57","0:09:03"],["0:08:36","0:08:42"],["0:08:16","0:08:21"],["0:07:55","0:08:00"],["0:07:35","0:07:40"],["0:07:14","0:07:19"],["0:06:54","0:06:58"],["0:06:33","0:06:38"]],"24":[["0:09:11","0:10:06"],["0:08:51","0:08:57"],["0:08:31","0:08:36"],["0:08:11","0:08:16"],["0:07:50","0:07:55"],["0:07:30","0:07:35"],["0:07:10","0:07:14"],["0:06:50","0:06:54"],["0:06:29","0:06:33"]],"25":[["0:09:05","0:10:00"],["0:08:45","0:08:51"],["0:08:25","0:08:31"],["0:08:05","0:08:11"],["0:07:45","0:07:50"],["0:07:25","0:07:30"],["0:07:05","0:07:10"],["0:06:45","0:06:50"],["0:06:25","0:06:29"]],"26":[["0:08:59","0:09:53"],["0:08:39","0:08:45"],["0:08:20","0:08:25"],["0:08:00","0:08:05"],["0:07:40","0:07:45"],["0:07:20","0:07:25"],["0:07:00","0:07:05"],["0:06:41","0:06:45"],["0:06:21","0:06:25"]],"27":[["0:08:53","0:09:47"],["0:08:34","0:08:39"],["0:08:14","0:08:20"],["0:07:55","0:08:00"],["0:07:35","0:07:40"],["0:07:15","0:07:20"],["0:06:56","0:07:00"],["0:06:36","0:06:41"],["0:06:17","0:06:21"]],"28":[["0:08:47","0:09:40"],["0:08:28","0:08:34"],["0:08:09","0:08:14"],["0:07:49","0:07:55"],["0:07:30","0:07:35"],["0:07:10","0:07:15"],["0:06:51","0:06:56"],["0:06:32","0:06:36"],["0:06:12","0:06:17"]],"29":[["0:08:41","0:09:33"],["0:08:22","0:08:28"],["0:08:03","0:08:09"],["0:07:44","0:07:49"],["0:07:25","0:07:30"],["0:07:06","0:07:10"],["0:06:46","0:06:51"],["0:06:27","0:06:32"],["0:06:08","0:06:12"]],"30":[["0:08:35","0:09:27"],["0:08:16","0:08:22"],["0:07:57","0:08:03"],["0:07:39","0:07:44"],["0:07:20","0:07:25"],["0:07:01","0:07:06"],["0:06:42","0:06:46"],["0:06:23","0:06:27"],["0:06:04","0:06:08"]],"31":[["0:08:29","0:09:20"],["0:08:11","0:08:16"],["0:07:52","0:07:57"],["0:07:33","0:07:39"],["0:07:15","0:07:20"],["0:06:56","0:07:01"],["0:06:37","0:06:42"],["0:06:18","0:06:23"],["0:06:00","0:06:04"]],"32":[["0:08:23","0:09:14"],["0:08:05","0:08:11"],["0:07:46","0:07:52"],["0:07:28","0:07:33"],["0:07:09","0:07:15"],["0:06:51","0:06:56"],["0:06:32","0:06:37"],["0:06:14","0:06:18"],["0:05:55","0:06:00"]],"33":[["0:08:17","0:09:07"],["0:07:59","0:08:05"],["0:07:41","0:07:46"],["0:07:23","0:07:28"],["0:07:04","0:07:09"],["0:06:46","0:06:51"],["0:06:28","0:06:32"],["0:06:09","0:06:14"],["0:05:51","0:05:55"]],"34":[["0:08:11","0:09:01"],["0:07:53","0:07:59"],["0:07:35","0:07:41"],["0:07:17","0:07:23"],["0:06:59","0:07:04"],["0:06:41","0:06:46"],["0:06:23","0:06:28"],["0:06:05","0:06:09"],["0:05:47","0:05:51"]],"35":[["0:08:05","0:08:54"],["0:07:48","0:07:53"],["0:07:30","0:07:35"],["0:07:12","0:07:17"],["0:06:54","0:06:59"],["0:06:36","0:06:41"],["0:06:18","0:06:23"],["0:06:01","0:06:05"],["0:05:43","0:05:47"]],"36":[["0:07:59","0:08:47"],["0:07:42","0:07:48"],["0:07:24","0:07:30"],["0:07:07","0:07:12"],["0:06:49","0:06:54"],["0:06:31","0:06:36"],["0:06:14","0:06:18"],["0:05:56","0:06:01"],["0:05:39","0:05:43"]],"37":[["0:07:53","0:08:41"],["0:07:36","0:07:42"],["0:07:19","0:07:24"],["0:07:01","0:07:07"],["0:06:44","0:06:49"],["0:06:26","0:06:31"],["0:06:09","0:06:14"],["0:05:52","0:05:56"],["0:05:34","0:05:39"]],"38":[["0:07:47","0:08:34"],["0:07:30","0:07:36"],["0:07:13","0:07:19"],["0:06:56","0:07:01"],["0:06:39","0:06:44"],["0:06:22","0:06:26"],["0:06:04","0:06:09"],["0:05:47","0:05:52"],["0:05:30","0:05:34"]],"39":[["0:07:41","0:08:28"],["0:07:25","0:07:30"],["0:07:08","0:07:13"],["0:06:51","0:06:56"],["0:06:34","0:06:39"],["0:06:17","0:06:22"],["0:06:00","0:06:04"],["0:05:43","0:05:47"],["0:05:26","0:05:30"]],"40":[["0:07:36","0:08:21"],["0:07:19","0:07:25"],["0:07:02","0:07:08"],["0:06:45","0:06:51"],["0:06:29","0:06:34"],["0:06:12","0:06:17"],["0:05:55","0:06:00"],["0:05:38","0:05:43"],["0:05:22","0:05:26"]],"41":[["0:07:30","0:08:14"],["0:07:13","0:07:19"],["0:06:56","0:07:02"],["0:06:40","0:06:45"],["0:06:23","0:06:29"],["0:06:07","0:06:12"],["0:05:50","0:05:55"],["0:05:34","0:05:38"],["0:05:17","0:05:22"]],"42":[["0:07:24","0:08:08"],["0:07:07","0:07:13"],["0:06:51","0:06:56"],["0:06:35","0:06:40"],["0:06:18","0:06:23"],["0:06:02","0:06:07"],["0:05:46","0:05:50"],["0:05:29","0:05:34"],["0:05:13","0:05:17"]],"43":[["0:07:18","0:08:01"],["0:07:01","0:07:07"],["0:06:45","0:06:51"],["0:06:29","0:06:35"],["0:06:13","0:06:18"],["0:05:57","0:06:02"],["0:05:41","0:05:46"],["0:05:25","0:05:29"],["0:05:09","0:05:13"]],"44":[["0:07:12","0:07:55"],["0:06:56","0:07:01"],["0:06:40","0:06:45"],["0:06:24","0:06:29"],["0:06:08","0:06:13"],["0:05:52","0:05:57"],["0:05:36","0:05:41"],["0:05:21","0:05:25"],["0:05:05","0:05:09"]],"45":[["0:07:06","0:07:48"],["0:06:50","0:06:56"],["0:06:34","0:06:40"],["0:06:19","0:06:24"],["0:06:03","0:06:08"],["0:05:47","0:05:52"],["0:05:32","0:05:36"],["0:05:16","0:05:21"],["0:05:01","0:05:05"]],"46":[["0:07:00","0:07:42"],["0:06:44","0:06:50"],["0:06:29","0:06:34"],["0:06:13","0:06:19"],["0:05:58","0:06:03"],["0:05:43","0:05:47"],["0:05:27","0:05:32"],["0:05:12","0:05:16"],["0:04:56","0:05:01"]],"47":[["0:06:54","0:07:35"],["0:06:38","0:06:44"],["0:06:23","0:06:29"],["0:06:08","0:06:13"],["0:05:53","0:05:58"],["0:05:38","0:05:43"],["0:05:22","0:05:27"],["0:05:07","0:05:12"],["0:04:52","0:04:56"]],"48":[["0:06:48","0:07:28"],["0:06:33","0:06:38"],["0:06:18","0:06:23"],["0:06:03","0:06:08"],["0:05:48","0:05:53"],["0:05:33","0:05:38"],["0:05:18","0:05:22"],["0:05:03","0:05:07"],["0:04:48","0:04:52"]],"49":[["0:06:42","0:07:22"],["0:06:27","0:06:33"],["0:06:12","0:06:18"],["0:05:57","0:06:03"],["0:05:43","0:05:48"],["0:05:28","0:05:33"],
  ["0:05:13","0:05:18"],["0:04:58","0:05:03"],["0:04:44","0:04:48"]],"50":[["0:06:36","0:07:15"],["0:06:21","0:06:27"],["0:06:07","0:06:12"],["0:05:52","0:05:57"],["0:05:38","0:05:43"],["0:05:23","0:05:28"],["0:05:08","0:05:13"],["0:04:54","0:04:58"],["0:04:39","0:04:44"]],"51":[["0:06:30","0:07:09"],["0:06:15","0:06:21"],["0:06:01","0:06:07"],["0:05:47","0:05:52"],["0:05:32","0:05:38"],["0:05:18","0:05:23"],["0:05:04","0:05:08"],["0:04:49","0:04:54"],["0:04:35","0:04:39"]],"52":[["0:06:24","0:07:02"],["0:06:10","0:06:15"],["0:05:56","0:06:01"],["0:05:41","0:05:47"],["0:05:27","0:05:32"],["0:05:13","0:05:18"],["0:04:59","0:05:04"],["0:04:45","0:04:49"],["0:04:31","0:04:35"]],"53":[["0:06:18","0:06:55"],["0:06:04","0:06:10"],["0:05:50","0:05:56"],["0:05:36","0:05:41"],["0:05:22","0:05:27"],["0:05:08","0:05:13"],["0:04:54","0:04:59"],["0:04:41","0:04:45"],["0:04:27","0:04:31"]],"54":[["0:06:12","0:06:49"],["0:05:58","0:06:04"],["0:05:44","0:05:50"],["0:05:31","0:05:36"],["0:05:17","0:05:22"],["0:05:03","0:05:08"],["0:04:50","0:04:54"],["0:04:36","0:04:41"],["0:04:22","0:04:27"]],"55":[["0:06:06","0:06:42"],["0:05:52","0:05:58"],["0:05:39","0:05:44"],["0:05:25","0:05:31"],["0:05:12","0:05:17"],["0:04:59","0:05:03"],["0:04:45","0:04:50"],["0:04:32","0:04:36"],["0:04:18","0:04:22"]],"56":[["0:06:00","0:06:36"],["0:05:47","0:05:52"],["0:05:33","0:05:39"],["0:05:20","0:05:25"],["0:05:07","0:05:12"],["0:04:54","0:04:59"],["0:04:40","0:04:45"],["0:04:27","0:04:32"],["0:04:14","0:04:18"]],"57":[["0:05:54","0:06:29"],["0:05:41","0:05:47"],["0:05:28","0:05:33"],["0:05:15","0:05:20"],["0:05:02","0:05:07"],["0:04:49","0:04:54"],["0:04:36","0:04:40"],["0:04:23","0:04:27"],["0:04:10","0:04:14"]],"58":[["0:05:48","0:06:23"],["0:05:35","0:05:41"],["0:05:22","0:05:28"],["0:05:09","0:05:15"],["0:04:57","0:05:02"],["0:04:44","0:04:49"],["0:04:31","0:04:36"],["0:04:18","0:04:23"],["0:04:06","0:04:10"]],"59":[["0:05:42","0:06:16"],["0:05:29","0:05:35"],["0:05:17","0:05:22"],["0:05:04","0:05:09"],["0:04:52","0:04:57"],["0:04:39","0:04:44"],["0:04:26","0:04:31"],["0:04:14","0:04:18"],["0:04:01","0:04:06"]],"60":[["0:05:36","0:06:09"],["0:05:23","0:05:29"],["0:05:11","0:05:17"],["0:04:59","0:05:04"],["0:04:46","0:04:52"],["0:04:34","0:04:39"],["0:04:22","0:04:26"],["0:04:09","0:04:14"],["0:03:57","0:04:01"]]}
  """

neutralRunnerTable = decodeString (dict (list string)) neutralRunnerJson |> Result.withDefault Dict.empty

trainingPacesTable : Dict String (List (String, String))
trainingPacesTable = decodeString (dict (list (list string))) trainingPacesJson
  |> Result.withDefault Dict.empty
  |> Dict.map (\k a -> List.map (\t -> Tuple.pair (List.head t) (List.head (List.tail t |> Maybe.withDefault [])) ) a )
  |> Dict.map (\k a -> List.map (\(x, y) -> (Maybe.withDefault "" x, Maybe.withDefault "" y)) a)

timeToSeconds : Int -> Int -> Int -> Int
timeToSeconds hours minutes seconds =
  (hours * 60 * 60)
    + (minutes * 60)
    + seconds

timeStrToSeconds : String -> Int
timeStrToSeconds str =
  let
    times = String.split ":" str
      |> List.map (String.toInt >> Maybe.withDefault 0)
  in
    case times of
        [hours, minutes, seconds] ->
          timeToSeconds hours minutes seconds
    
        _ ->
          0
  
  
lookup : String -> Int -> Result String Int
lookup distance seconds =
  let
    levelNum = Dict.get distance neutralRunnerTable 
      |> Maybe.map (List.map timeStrToSeconds)
      |> Maybe.map (List.partition (\time -> time > seconds))
      |> Maybe.map Tuple.first
      |> Maybe.map List.length
  in
    case levelNum of
      Just 0 ->
        Err "out of range"
      Just 61 ->
        Err "out of range"
      Nothing ->
        Err ("invalid distance: " ++ distance)
      Just level ->
        Ok level


equivalentRaceTimes : Int -> List (String, String)
equivalentRaceTimes level =
  List.map (\k -> (k, Dict.get k neutralRunnerTable |> Maybe.withDefault [])) distanceList
    |> List.map (\(k, v) -> (k, List.drop level v |> List.head |> Maybe.withDefault ""))

trainingPaces : Int -> List (String, (String, String))
trainingPaces level =
  let
    res = Dict.get (String.fromInt level) trainingPacesTable
  in
    case res of
        Just list ->
          List.map2 (\x y -> Tuple.pair x y) paceList list

        Nothing ->
          []